toqito.state_opt.state_distinguishability
=========================================

.. py:module:: toqito.state_opt.state_distinguishability

.. autoapi-nested-parse::

   Calculates the probability of optimally distinguishing quantum states.





Module Contents
---------------

.. py:function:: state_distinguishability(vectors, probs = None, strategy = 'min_error', solver = 'cvxopt', primal_dual = 'dual', **kwargs)

   Compute probability of state distinguishability :footcite:`Eldar_2003_SDPApproach`.

   The "quantum state distinguishability" problem involves a collection of :math:`n` quantum states

   .. math::
       \rho = \{ \rho_1, \ldots, \rho_n \},

   as well as a list of corresponding probabilities

   .. math::
       p = \{ p_1, \ldots, p_n \}.

   Alice chooses :math:`i` with probability :math:`p_i` and creates the state :math:`\rho_i`. Bob
   wants to guess which state he was given from the collection of states.

   For :code:`strategy = "min_error"`, this is the default method that yields the minimal
   probability of error for Bob.

   In that case, this function implements the following semidefinite program that provides the
   optimal probability with which Bob can conduct quantum state distinguishability.

   .. math::
       \begin{align*}
           \text{maximize:} \quad & \sum_{i=0}^n p_i \langle M_i, \rho_i \rangle \\
           \text{subject to:} \quad & M_0 + \ldots + M_n = \mathbb{I},\\
                                    & M_0, \ldots, M_n \geq 0.
       \end{align*}

   For :code:`strategy = "unambiguous"`, Bob never provides an incorrect answer, although it is
   possible that his answer is inconclusive.

   In that case, this function implements the following semidefinite program that provides the
   optimal probability with which Bob can conduct unambiguous quantum state distinguishability.

   .. math::
       \begin{align*}
           \text{maximize:} \quad & \mathbf{p} \cdot \mathbf{q} \\
           \text{subject to:} \quad & \Gamma - Q \geq 0,\\
                                    & \mathbf{q} \geq 0
       \end{align*}

   .. math::
       \begin{align*}
           \text{minimize:} \quad & \text{Tr}(\Gamma Z) \\
           \text{subject to:} \quad & z_i + p_i + \text{Tr}\left(F_iZ\right)=0,\\
                                    & Z, z \geq 0
       \end{align*}

   where :math:`\mathbf{p}` is the vector whose :math:`i`-th coordinate contains the probability
   that the state is prepared in state :math:`\left|\psi_i\right\rangle`, :math:`\Gamma` is
   the Gram matrix of :math:`\left|\psi_1\right\rangle,\cdots,\left|\psi_n\right\rangle` and :math:`F_i` is
   :math:`-|i\rangle\langle i|`.

   .. note::
       For unambiguous discrimination, this function supports both pure states (vectors) and mixed states
       (density matrices). For pure states, the states should be linearly independent. For mixed states,
       the Gram matrix is computed as Tr(ρᵢ ρⱼ). If the states cannot be unambiguously distinguished,
       the optimal probability will be low or zero.

   .. rubric:: Examples

   Minimal-error state distinguishability for the Bell states (which are perfectly distinguishable).

   .. jupyter-execute::

    import numpy as np
    from toqito.states import bell
    from toqito.state_opt import state_distinguishability

    states = [bell(0), bell(1), bell(2), bell(3)]
    probs = [1 / 4, 1 / 4, 1 / 4, 1 / 4]

    res, _ = state_distinguishability(vectors=states, probs=probs, primal_dual="dual")

    np.around(res, decimals=2)

   Note that if we are just interested in obtaining the optimal value, it is computationally less intensive to compute
   the dual problem over the primal problem. However, the primal problem does allow us to extract the explicit
   measurement operators which may be of interest to us.

   .. jupyter-execute::

    import numpy as np
    from toqito.states import bell
    from toqito.state_opt import state_distinguishability

    states = [bell(0), bell(1), bell(2), bell(3)]
    probs = [1 / 4, 1 / 4, 1 / 4, 1 / 4]

    res, measurements = state_distinguishability(vectors=states, probs=probs, primal_dual="primal")

    np.around(measurements[0], decimals=5)

   Unambiguous state distinguishability for unbiased pure states.

   .. jupyter-execute::

    import numpy as np
    from toqito.state_opt import state_distinguishability

    states = [np.array([[1.], [0.]]), np.array([[1.],[1.]]) / np.sqrt(2)]
    probs = [1 / 2, 1 / 2]

    res, _ = state_distinguishability(vectors=states, probs=probs, primal_dual="primal", strategy="unambiguous")

    np.around(res, decimals=2)

   Unambiguous state distinguishability for mixed states.

   .. jupyter-execute::

    import numpy as np
    from toqito.state_opt import state_distinguishability

    # Two mixed states (Werner-like states)
    rho1 = 0.7 * np.array([[1., 0.], [0., 0.]]) + 0.3 * np.eye(2) / 2
    rho2 = 0.7 * np.array([[0., 0.], [0., 1.]]) + 0.3 * np.eye(2) / 2
    states = [rho1, rho2]
    probs = [1 / 2, 1 / 2]

    res, _ = state_distinguishability(vectors=states, probs=probs, primal_dual="primal", strategy="unambiguous")

    np.around(res, decimals=2)

   .. rubric:: References

   .. footbibliography::

   :param vectors: A list of states provided as vectors (for pure states) or density matrices (for mixed states).
   :param probs: Respective list of probabilities each state is selected. If no
                 probabilities are provided, a uniform probability distribution is assumed.
   :param strategy: Whether to perform unambiguous or minimal error discrimination task. Possible
                    values are "min_error" and "unambiguous". Default option is `strategy="min_error"`.
                    Both strategies support pure and mixed states.
   :param solver: Optimization option for `picos` solver. Default option is `solver="cvxopt"`.
   :param primal_dual: Option for the optimization problem. Default option is `"dual"`.
   :param kwargs: Additional arguments to pass to picos' solve method.
   :return: The optimal probability with which Bob can guess the state he was
            not given from `states` along with the optimal set of measurements.



