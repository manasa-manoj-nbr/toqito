toqito.matrix_props.factor_width
================================

.. py:module:: toqito.matrix_props.factor_width

.. autoapi-nested-parse::

   Determine the factor width of a positive semidefinite matrix.





Module Contents
---------------

.. py:function:: factor_width(mat, k, *, solver = 'SCS', solver_kwargs = None, tol = 1e-08)

   Decide whether a positive semidefinite matrix has factor width at most :math:`k`.

   The factor width of a matrix is the minimal value of :math:`k` for which it
   admits a decomposition :math:`M = \sum_j v_j v_j^*` with each :math:`v_j`
   supported on at most :math:`k` coordinates.  This routine implements the
   low-rank algorithm in :footcite:`Johnston_2025_Complexity`.

   .. rubric:: Examples

   The matrix :math:`\operatorname{diag}(1, 1, 0)` has factor width at most :math:`1`.

   .. jupyter-execute::

       import numpy as np
       from toqito.matrix_props import factor_width

       diag_mat = np.diag([1, 1, 0])
       result = factor_width(diag_mat, k=1)
       result["feasible"]

   Conversely, the rank-one matrix :math:`\begin{pmatrix} 1 & 1 \\ 1 & 1 \end{pmatrix}/2` is not
   :math:`1`-factorable.

   .. jupyter-execute::

       import numpy as np
       from toqito.matrix_props import factor_width

       hadamard = np.array([[1, 1], [1, 1]], dtype=np.complex128) / 2
       result = factor_width(hadamard, k=1)
       result["feasible"]

   :param mat: Positive semidefinite matrix to test.
   :param k: Target factor width bound.
   :param solver: CVXPY solver name (defaults to :code:`"SCS"`).
   :param solver_kwargs: Additional keyword arguments forwarded to
       :meth:`cvxpy.Problem.solve`.
   :param tol: Numerical tolerance used for rank computations and duplicate detection.
   :return: Dictionary with keys
       ``feasible`` (boolean flag),
       ``status`` (solver status string),
       ``factors`` (list of PSD matrices whose sum equals ``mat`` when feasible), and
       ``subspaces`` (orthonormal bases spanning the subspaces used in the decomposition).


